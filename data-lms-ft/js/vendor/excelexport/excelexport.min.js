window.btoa||(window.btoa=function(e){for(var t,n,o,r,a,c,i=0,s=e.length,l=Math.max,u="",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i<s;){if(l(t=e.charCodeAt(i++)||0,n=e.charCodeAt(i++)||0,c=e.charCodeAt(i++)||0)>255)return;o=(3&t)<<4|n>>4&15,r=(15&n)<<2|c>>6&3,a=63&c,n?c||(a=64):r=a=64,u+=d.charAt(t>>2&63)+d.charAt(o)+d.charAt(r)+d.charAt(a)}return u}),excelExport=function(e){var t,n,o=document.getElementById(e),r={csv:"data:application/csv;base64,",xls:"data:application/vnd.ms-excel;base64,"},a=function(e,t){var n=document.createElement("input");return n.type="hidden",n.name=t,n.value=e,n},c=function(e,t,n,o){var r,c,i=(r=e,(c=document.createElement("form")).method="POST",c.action=r,c),s=a(t,"type"),l=a(n,"data"),u=a(o,"filename");i.appendChild(s),i.appendChild(l),i.appendChild(u),document.body.appendChild(i),i.submit()},i=function(e,t){return r[e]+window.btoa(unescape(encodeURIComponent(t)))};return{parseToCSV:function(){for(var e=[],n=0;n<o.rows.length;n++){for(var r=[],a=0;a<o.rows[n].cells.length;a++){var c=o.rows[n].cells[a],i=c.innerHTML;if((i=i.replace("<br>","\r\n")).match(/[,\r\n]/)&&(i='"'+i.replace('"','""')+'"'),r.push(i),c.getAttribute("colspan")){var s=c.getAttribute("colspan");if((s=parseInt(s,10))>=2)for(var l=0;l<s-1;l++)r.push("")}}e.push(r.join(","))}return t=e.join("\n"),this},getRawCSV:function(){return t||!1},getCSVDataURI:function(){return!!t&&i("csv",t)},downloadCSV:function(e,n){if(!t)return!1;c(e,"csv",t,n)},parseToXLS:function(e){return e||(e="Sheet"),n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>",n+=e+"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>",n+=o.innerHTML+"</table></body></html>",this},getRawXLS:function(){return n||!1},getXLSDataURI:function(){return!!n&&i("xls",n)},downloadXLS:function(e,t){if(!n)return!1;c(e,"xls",n,t)}}};