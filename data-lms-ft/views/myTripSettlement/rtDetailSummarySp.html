<!--ControllerAs: rtDetSummaryVm-->

<div class="modal-header" >
	<button type="button" ng-click="rtDetSummaryVm.closeModal()" class="close"
			data-dismiss="modal" aria-label="Close">
		<span aria-hidden="true">&times;</span>
	</button>
	<div>
		<div class="col-md-2">
			<button ng-click="printDiv('idOne')" class="btn btn-primary glyphicon glyphicon-print" style="margin-bottom: 12px;"> PRINT </button>
		</div>
	</div>
	<div class="clearfix"></div>
</div>
<div class="clearfix"></div>
<div class="modal-body">
	<div id="idOne">

		<div style="width: 100%;">
			<div class="table-responsive" style="width: 100%;">
				<table class="table ja-table" style="width: 100%;border-spacing: 0px;" border="1">
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black; padding: 0 3px 0 3px;"><b style="white-space: nowrap;">RT No.: </b>{{rtDetSummaryVm.aTrips[0].advSettled.tsNo}}</td>
									<td style="border-right: 1px solid black; padding: 0 3px 0 3px;"><b style="white-space: nowrap;">Stlmt Date: </b>{{rtDetSummaryVm.aTrips[0].markSettle.date | date:'dd-MM-yyyy'}}</td>
									<td style="border-right: 1px solid black; padding: 0 3px 0 3px;"><b style="white-space: nowrap;">Audit Date: </b>{{rtDetSummaryVm.aTrips[0].markSettle.date | date:'dd-MM-yyyy'}} {{rtDetSummaryVm.aTrips[0].advSettled.date | date:'dd-MM-yyyy'}}</td>
									<td style="border-right: 1px solid black;"><b>Stlmt By: </b>{{rtDetSummaryVm.aTrips[0].markSettle.user_full_name}}</td>
									<td><b>Audit By: </b>{{rtDetSummaryVm.aTrips[0].markSettle.user_full_name}} {{rtDetSummaryVm.aTrips[0].advSettled.user_full_name}}</td>
								</tr>
							</table>
						</td>
					</tr>
					<!--<tr style="border-top: 1px solid black">-->
					<!--<td style="padding: 10px; border-top: 1px solid black">-->
					<!--</td>-->
					<!--</tr>-->
					<!--<tr style="border-top: 1px solid black">-->
					<!--<td style="padding: 0px; border-top: 1px solid black">-->
					<!--<table class="insideTable" style="width: 100%;border-spacing: 0px;">-->
					<!--<tr style="text-align: center">-->
					<!--<td style="border-right: 1px solid black;"><b>RT Creation: </b></td>-->
					<!--<td><b>RT User: </b></td>-->
					<!--</tr>-->
					<!--</table>-->
					<!--</td>-->
					<!--</tr>-->
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;"><b>Vehicle No.: </b>{{rtDetSummaryVm.aTrips[0].vehicle_no}}</td>
									<td style="border-right: 1px solid black;"><b>RT Period: </b>
										{{rtDetSummaryVm.aTrips[0].tripStarted | date:'dd-MM-yyyy'}}
										{{rtDetSummaryVm.aTrips.slice(-1)[0].tripEnded ? 'To' : ''}}
										{{rtDetSummaryVm.aTrips.slice(-1)[0].tripEnded | date:'dd-MM-yyyy'}}
									</td>
									<td style="border-right: 1px solid black;"><b>Driver: </b>{{rtDetSummaryVm.aDriver}}</td>
									<td style="border-right: 1px solid black;"><b>Dr. ST & LC Exp.:</b>{{rtDetSummaryVm.aDriverStatus}}&nbsp;&&nbsp;{{rtDetSummaryVm.aDriver_expiry | date:'dd-MM-yyyy'}}</td>
									<td><b>Dr. Op. Bal: </b>
										{{((rtDetSummaryVm.summary.openCloseBal.driver.opening +
										rtDetSummaryVm.summary.openCloseBal.fastag.opening + rtDetSummaryVm.summary.openCloseBal.happay.opening
										+ rtDetSummaryVm.summary.openCloseBal.vendor.opening) || 0)|roundOff:''}}
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>Route : </b>{{(rtDetSummaryVm.aTrips|arrayOfObjectToArray:'route_name'|mergeString:', ') || rtDetSummaryVm.aTrips[0].rName || 'NA'}}</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;"><b>RT Prediction </b></td>
									<td style="border-right: 1px solid black;"><b>Budgeted Diesel: </b>{{(rtDetSummaryVm.summary.dieselBudget|roundOff:'') || 0}}</td>
									<td style="border-right: 1px solid black;"><b>Budgeted Advance: </b>{{(rtDetSummaryVm.summary.netBudget|roundOff:'') || 0}}</td>
									<td style="border-right: 1px solid black;"><b>Net Suspense: </b>{{(rtDetSummaryVm.aggrOfSupense|roundOff:'') || 0}}</td>
									<td><b>Suspense Remark: {{rtDetSummaryVm.susRemark}}</b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>Actual Advance In Total: </b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;"><b>Total Of Happay: </b>{{(rtDetSummaryVm.summary.netAdvObj.happay|roundOff:'') || 0}}</td>
									<td style="border-right: 1px solid black;"><b>Total Of Dr. Cash: </b>{{(rtDetSummaryVm.summary.netAdvObj.driverCash|roundOff:'') || 0}}</td>
									<td style="border-right: 1px solid black;"><b>Total Of Diesel(Lit): </b>{{(rtDetSummaryVm.summary.netAdvObj.diesel|roundOff:'') || 0}}({{(rtDetSummaryVm.summary.dieselGivLit|roundOff)|| 0}})</td>
									<td><b>Total Of Fastag: </b>{{(rtDetSummaryVm.summary.netAdvObj.fastag|roundOff:'') || 0}}</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>RT Details </b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;"><b>Trip Km: </b>{{rtDetSummaryVm.summary.totalKm - rtDetSummaryVm.summary.totalExtraKm}}</td>
									<td style="border-right: 1px solid black;"><b>Extra KM: </b>{{rtDetSummaryVm.summary.totalExtraKm || '0'}}</td>
									<td style="border-right: 1px solid black;"><b>Total Km: </b>{{rtDetSummaryVm.summary.totalKm || '0'}}</td>
									<td style="border-right: 1px solid black;"><b>Total Advance: </b>{{(rtDetSummaryVm.summary.netAdvance|roundOff:'')||0}}</td>
									<td style="border-right: 1px solid black;"><b>Total Expense: </b>{{(rtDetSummaryVm.summary.netExpense|roundOff:'') ||0}}</td>
									<td style="border-right: 1px solid black;"><b>Dr. Payment: </b>{{(rtDetSummaryVm.summary.driverPayment|roundOff:'') || 0}}</td>
									<td style="border-right: 1px solid black;"><b>Trip Balance: </b>{{((rtDetSummaryVm.summary.netAdvance - rtDetSummaryVm.summary.netExpense - rtDetSummaryVm.summary.driverPayment)|roundOff:'')||0}}</td>
									<td><b>Dr. Cl. Bal.: </b>
										{{(rtDetSummaryVm.summary.openCloseBal.driver.closing +
										rtDetSummaryVm.summary.openCloseBal.fastag.closing +
										rtDetSummaryVm.summary.openCloseBal.happay.closing +
										rtDetSummaryVm.summary.openCloseBal.vendor.closing).toFixed(2) || 0}}</td>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black;">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>RT Performance </b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;"><b>Advance Per Km: </b>{{((rtDetSummaryVm.summary.netAdvance ||0) /(rtDetSummaryVm.summary.totalKm||1))|roundOff:''}}</td>
									<td style="border-right: 1px solid black;"><b>Expense Per Km: </b>{{((rtDetSummaryVm.summary.netExpense || 0) /(rtDetSummaryVm.summary.totalKm||1))|roundOff:''}}</td>
									<td style="border-right: 1px solid black;"><b>Balance Per Km: </b>{{((((rtDetSummaryVm.summary.netAdvance || 0) - rtDetSummaryVm.summary.netExpense ||0) || 0)/ (rtDetSummaryVm.summary.totalKm ||1))|roundOff:''}}</td>
									<td><b>Running Km/Day: </b>
										{{(rtDetSummaryVm.summary.totalKm / ('calDays'|dateUtilsFilt:rtDetSummaryVm.aTrips.slice(-1)[0].tripEnded:rtDetSummaryVm.aTrips[0].tripStarted))|roundOff:''}}
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black">
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>Trip Details </b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>S.No </b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Allocation Date</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>TripStart</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>TripEnd</b></td>
<!--									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Trip No</b></td>-->
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Consignor</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Gr No</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Route</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Route Km</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Driver Name</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>AR No</b></td>
									<td style="border-bottom: 1px solid black;"><b>Pod Status</b></td>
								</tr>
								<tr ng-repeat="oTrip in rtDetSummaryVm.aTrips">
									<td style="border-right: 1px solid black;">{{$index+1}}</td>
									<td style="border-right: 1px solid black;text-align: left; padding: 0 3px 0 3px; white-space: nowrap;">{{oTrip.allocation_date | date:'dd-MM-yyyy'}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{((oTrip.statuses | filter:{"status": "Trip started"})[0].date | date:"dd-MMM-yyyy")}}</td>
									<td style="border-right: 1px solid black;text-align: right">{{((oTrip.statuses | filter:{"status": "Trip ended"})[0].date | date:"dd-MMM-yyyy")}}</td>
<!--									<td style="border-right: 1px solid black;text-align: right">{{oTrip.trip_no}}</td>-->
									<td style="border-right: 1px solid black;text-align: left">{{oTrip.gr[0].consignor.name}}</td>
									<td style="border-right: 1px solid black;text-align: right">{{oTrip.gr|arrayOfGrToString}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oTrip.route_name||oTrip.rName}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oTrip.route.route_distance||oTrip.rKm}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oTrip.driver.name}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oTrip.gr[0].pod.arNo}}</td>
									<td>{{oTrip.gr[0].pod.received ? "Received" : "Not Received"}}</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black;">
						</td>
					</tr>

				</table>

				<table class="table ja-table" style="width: 100%;border-spacing: 0px;" border="1">
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr>
									<td style="padding-left: 10px"><b>All Advance Details </b></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 0px; border-top: 1px solid black">
							<table class="insideTable" style="width: 100%;border-spacing: 0px;">
								<tr style="text-align: center">
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>S.No </b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Advance Date</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Advance Type</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Reference no</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Amount</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Diesel Ltr</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Diesel vendor</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Diesel rate</b></td>
									<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Advance remark</b></td>
									<td style="border-bottom: 1px solid black;"><b>Trip no </b></td>
								</tr>
								<tr ng-repeat="oAdv in rtDetSummaryVm.aAdvances | orderBy:'-date'">
									<td style="border-right: 1px solid black;">{{$index+1}}</td>
									<td style="border-right: 1px solid black;text-align: left; padding: 0 3px 0 3px; white-space: nowrap;">{{oAdv.date | date:'dd-MM-yyyy'}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oAdv.advanceType}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oAdv.reference_no}}</td>
									<td style="border-right: 1px solid black;text-align: right">{{oAdv.amount|roundOff:''}}</td>
									<td style="border-right: 1px solid black;text-align: right">{{oAdv.dieseInfo.litre|roundOff:''}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{oAdv.dieseInfo.vendor.name}}</td>
									<td style="border-right: 1px solid black;text-align: right">{{oAdv.dieseInfo.rate|roundOff:''}}</td>
									<td style="border-right: 1px solid black;text-align: left">{{(oAdv.narration || '').concat("  ",(oAdv.remark || ''))  || 'NA'}}</td>
									<td>{{oAdv.trip_no}}</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr style="border-top: 1px solid black">
						<td style="padding: 10px; border-top: 1px solid black;">
						</td>
					</tr>
				</table>

				<table class="table ja-table" style="width: 100%;border-spacing: 0px;" border="1">
					<tbody>
						<tr style="border-top: 1px solid black">
							<td style="padding: 0px; border-top: 1px solid black;">
								<table class="insideTable" style="width: 100%;border-spacing: 0px;">
									<tr>
										<td style="padding-left: 10px"><b>Details of Expense </b></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr style="border-top: 1px solid black">
							<td style="padding: 0px; border-top: 1px solid black">
								<table class="insideTable" style="width: 100%;border-spacing: 0px;">
									<tr style="text-align: center">
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>S.No </b></td>
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Expense Type</b></td>
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Expense Amount</b></td>
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Person</b></td>
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Entry Date</b></td>
										<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Remark</b></td>
										<!--<td style="border-right: 1px solid black;border-bottom: 1px solid black;"><b>Reference no</b></td>-->
										<td style="text-align: left;border-bottom: 1px solid black;"><b>Entry By</b></td>
									</tr>
									<tr ng-repeat="oExp in rtDetSummaryVm.aExpense">
										<td style="border-right: 1px solid black;">{{$index+1}}</td>
										<td style="border-right: 1px solid black;text-align: left">{{oExp.type}}</td>
										<td style="border-right: 1px solid black;text-align: right">{{oExp.amount|roundOff:''}}</td>
										<td style="border-right: 1px solid black;text-align: right">{{oExp.person}}</td>
										<td style="border-right: 1px solid black;text-align: left; padding: 0 3px 0 3px; white-space: nowrap;">{{oExp.created_at | date:'dd-MM-yyyy'}}</td>
										<td style="border-right: 1px solid black;text-align: left">{{oExp.remark}}</td>
										<!--<td style="border-right: 1px solid black;text-align: right">{{oExp.reference_no}}</td>-->
										<td style="text-align: left">{{oExp.voucher.created_by.full_name}}</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td style="padding-top: 7px;">
								<table class="insideTable" style="width: 100%; ">
									<tr ng-show="rtDetSummaryVm.aTrips[0].markSettle.remark">
										<td style="padding-left: 4px;"><b>Settled Remark:</b> <span style="padding-left:9px;">{{rtDetSummaryVm.aTrips[0].markSettle.remark}}</span></td>
									</tr>
									<tr ng-show="rtDetSummaryVm.aTrips[0].advSettled.remark">
										<td style="padding-left: 4px; padding-top: 3px;"><b>Manager Remark:</b> {{rtDetSummaryVm.aTrips[0].advSettled.remark}}</td>
									</tr>
									<tr ng-show=rtDetSummaryVm.aTrips[0].AccManagerRmk.remark">
										<td style="padding-left: 4px; padding-top: 3px;"><b>Account Manager Remark:</b> {{rtDetSummaryVm.aTrips[0].AccManagerRmk.remark}}</td>
									</tr>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
<div class="modal-footer">
	<button class="btn btn-warning" ng-click="rtDetSummaryVm.closeModal()">Close</button>
</div>


<style type="text/css">

	.modal-dialog {width: 75%;
		height: 173px
	}

	.fs-12{
		font-size: 11px;
	}

	.text-center{
		text-align: center;
	}

	.ja-table > tbody > tr > td{
		border: 1px solid #000000;
		padding: 2px 5px !important;
		border-spacing: 0px;
	}

	.insideTable > tbody > tr > td{
		border-right: 1px solid black;
	}

	.insideTable > tbody > tr > td:last-child{
		border-right: 0px solid black;
	}
</style>
